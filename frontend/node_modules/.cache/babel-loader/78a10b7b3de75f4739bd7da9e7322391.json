{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { ownerDocument } from '@mui/material/utils';\nimport { GridEvents } from '../../../models/events';\nimport { useGridApiMethod } from '../../utils/useGridApiMethod';\nimport { useGridLogger } from '../../utils/useGridLogger';\nimport { useGridApiEventHandler } from '../../utils/useGridApiEventHandler';\nimport { isNavigationKey } from '../../../utils/keyboardUtils';\nimport { useGridStateInit } from '../../utils/useGridStateInit';\nimport { gridFocusCellSelector } from './gridFocusStateSelector';\n/**\n * @requires useGridParamsApi (method)\n * @requires useGridRows (method)\n * @requires useGridEditing (event)\n */\n\nexport const useGridFocus = (apiRef, props) => {\n  const logger = useGridLogger(apiRef, 'useGridFocus');\n  useGridStateInit(apiRef, state => _extends({}, state, {\n    focus: {\n      cell: null,\n      columnHeader: null\n    },\n    tabIndex: {\n      cell: null,\n      columnHeader: null\n    }\n  }));\n  const lastClickedCell = React.useRef(null);\n  const setCellFocus = React.useCallback((id, field) => {\n    // The row might have been deleted\n    if (!apiRef.current.getRow(id)) {\n      return;\n    }\n\n    const focusedCell = gridFocusCellSelector(apiRef);\n\n    if ((focusedCell == null ? void 0 : focusedCell.id) === id && focusedCell.field === field) {\n      return;\n    }\n\n    apiRef.current.setState(state => {\n      logger.debug(`Focusing on cell with id=${id} and field=${field}`);\n      return _extends({}, state, {\n        tabIndex: {\n          cell: {\n            id,\n            field\n          },\n          columnHeader: null\n        },\n        focus: {\n          cell: {\n            id,\n            field\n          },\n          columnHeader: null\n        }\n      });\n    });\n    apiRef.current.forceUpdate();\n    apiRef.current.publishEvent(GridEvents.cellFocusIn, apiRef.current.getCellParams(id, field));\n  }, [apiRef, logger]);\n  const setColumnHeaderFocus = React.useCallback(function (field) {\n    let event = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const cell = gridFocusCellSelector(apiRef);\n\n    if (cell) {\n      apiRef.current.publishEvent(GridEvents.cellFocusOut, apiRef.current.getCellParams(cell.id, cell.field), event);\n    }\n\n    apiRef.current.setState(state => {\n      logger.debug(`Focusing on column header with colIndex=${field}`);\n      return _extends({}, state, {\n        tabIndex: {\n          columnHeader: {\n            field\n          },\n          cell: null\n        },\n        focus: {\n          columnHeader: {\n            field\n          },\n          cell: null\n        }\n      });\n    });\n    apiRef.current.forceUpdate();\n  }, [apiRef, logger]);\n  const handleCellDoubleClick = React.useCallback(_ref => {\n    let {\n      id,\n      field\n    } = _ref;\n    apiRef.current.setCellFocus(id, field);\n  }, [apiRef]);\n  const handleCellKeyDown = React.useCallback((params, event) => {\n    // GRID_CELL_NAVIGATION_KEY_DOWN handles the focus on Enter, Tab and navigation keys\n    if (event.key === 'Enter' || event.key === 'Tab' || isNavigationKey(event.key)) {\n      return;\n    }\n\n    apiRef.current.setCellFocus(params.id, params.field);\n  }, [apiRef]);\n  const handleColumnHeaderFocus = React.useCallback((_ref2, event) => {\n    let {\n      field\n    } = _ref2;\n\n    if (event.target !== event.currentTarget) {\n      return;\n    }\n\n    apiRef.current.setColumnHeaderFocus(field, event);\n  }, [apiRef]);\n  const handleBlur = React.useCallback(() => {\n    logger.debug(`Clearing focus`);\n    apiRef.current.setState(state => _extends({}, state, {\n      focus: {\n        cell: null,\n        columnHeader: null\n      }\n    }));\n  }, [logger, apiRef]);\n  const handleCellMouseUp = React.useCallback(params => {\n    lastClickedCell.current = params;\n  }, []);\n  const handleDocumentClick = React.useCallback(event => {\n    const cellParams = lastClickedCell.current;\n    lastClickedCell.current = null;\n    const focusedCell = gridFocusCellSelector(apiRef);\n\n    if (!focusedCell) {\n      if (cellParams) {\n        apiRef.current.setCellFocus(cellParams.id, cellParams.field);\n      }\n\n      return;\n    }\n\n    if ((cellParams == null ? void 0 : cellParams.id) === focusedCell.id && (cellParams == null ? void 0 : cellParams.field) === focusedCell.field) {\n      return;\n    }\n\n    const cellElement = apiRef.current.getCellElement(focusedCell.id, focusedCell.field);\n\n    if (cellElement != null && cellElement.contains(event.target)) {\n      return;\n    } // The row might have been deleted during the click\n\n\n    if (!apiRef.current.getRow(focusedCell.id)) {\n      return;\n    } // There's a focused cell but another cell was clicked\n    // Publishes an event to notify that the focus was lost\n\n\n    apiRef.current.publishEvent(GridEvents.cellFocusOut, apiRef.current.getCellParams(focusedCell.id, focusedCell.field), event);\n\n    if (cellParams) {\n      apiRef.current.setCellFocus(cellParams.id, cellParams.field);\n    } else {\n      apiRef.current.setState(state => _extends({}, state, {\n        focus: {\n          cell: null,\n          columnHeader: null\n        }\n      }));\n      apiRef.current.forceUpdate();\n    }\n  }, [apiRef]);\n  const handleCellModeChange = React.useCallback(params => {\n    if (params.cellMode === 'view') {\n      return;\n    }\n\n    const cell = gridFocusCellSelector(apiRef);\n\n    if ((cell == null ? void 0 : cell.id) !== params.id || (cell == null ? void 0 : cell.field) !== params.field) {\n      apiRef.current.setCellFocus(params.id, params.field);\n    }\n  }, [apiRef]);\n  useGridApiMethod(apiRef, {\n    setCellFocus,\n    setColumnHeaderFocus\n  }, 'GridFocusApi');\n  React.useEffect(() => {\n    const cell = gridFocusCellSelector(apiRef);\n\n    if (cell) {\n      const updatedRow = apiRef.current.getRow(cell.id);\n\n      if (!updatedRow) {\n        apiRef.current.setState(state => _extends({}, state, {\n          focus: {\n            cell: null,\n            columnHeader: null\n          }\n        }));\n      }\n    }\n  }, [apiRef, props.rows]);\n  React.useEffect(() => {\n    const doc = ownerDocument(apiRef.current.rootElementRef.current);\n    doc.addEventListener('click', handleDocumentClick);\n    return () => {\n      doc.removeEventListener('click', handleDocumentClick);\n    };\n  }, [apiRef, handleDocumentClick]);\n  useGridApiEventHandler(apiRef, GridEvents.columnHeaderBlur, handleBlur);\n  useGridApiEventHandler(apiRef, GridEvents.cellDoubleClick, handleCellDoubleClick);\n  useGridApiEventHandler(apiRef, GridEvents.cellMouseUp, handleCellMouseUp);\n  useGridApiEventHandler(apiRef, GridEvents.cellKeyDown, handleCellKeyDown);\n  useGridApiEventHandler(apiRef, GridEvents.cellModeChange, handleCellModeChange);\n  useGridApiEventHandler(apiRef, GridEvents.columnHeaderFocus, handleColumnHeaderFocus);\n};","map":{"version":3,"sources":["/Users/kenleyshaw 1/Desktop/school/visual studio/HangoutApp/frontend/node_modules/@mui/x-data-grid/hooks/features/focus/useGridFocus.js"],"names":["_extends","React","ownerDocument","GridEvents","useGridApiMethod","useGridLogger","useGridApiEventHandler","isNavigationKey","useGridStateInit","gridFocusCellSelector","useGridFocus","apiRef","props","logger","state","focus","cell","columnHeader","tabIndex","lastClickedCell","useRef","setCellFocus","useCallback","id","field","current","getRow","focusedCell","setState","debug","forceUpdate","publishEvent","cellFocusIn","getCellParams","setColumnHeaderFocus","event","cellFocusOut","handleCellDoubleClick","handleCellKeyDown","params","key","handleColumnHeaderFocus","target","currentTarget","handleBlur","handleCellMouseUp","handleDocumentClick","cellParams","cellElement","getCellElement","contains","handleCellModeChange","cellMode","useEffect","updatedRow","rows","doc","rootElementRef","addEventListener","removeEventListener","columnHeaderBlur","cellDoubleClick","cellMouseUp","cellKeyDown","cellModeChange","columnHeaderFocus"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { ownerDocument } from '@mui/material/utils';\nimport { GridEvents } from '../../../models/events';\nimport { useGridApiMethod } from '../../utils/useGridApiMethod';\nimport { useGridLogger } from '../../utils/useGridLogger';\nimport { useGridApiEventHandler } from '../../utils/useGridApiEventHandler';\nimport { isNavigationKey } from '../../../utils/keyboardUtils';\nimport { useGridStateInit } from '../../utils/useGridStateInit';\nimport { gridFocusCellSelector } from './gridFocusStateSelector';\n/**\n * @requires useGridParamsApi (method)\n * @requires useGridRows (method)\n * @requires useGridEditing (event)\n */\n\nexport const useGridFocus = (apiRef, props) => {\n  const logger = useGridLogger(apiRef, 'useGridFocus');\n  useGridStateInit(apiRef, state => _extends({}, state, {\n    focus: {\n      cell: null,\n      columnHeader: null\n    },\n    tabIndex: {\n      cell: null,\n      columnHeader: null\n    }\n  }));\n  const lastClickedCell = React.useRef(null);\n  const setCellFocus = React.useCallback((id, field) => {\n    // The row might have been deleted\n    if (!apiRef.current.getRow(id)) {\n      return;\n    }\n\n    const focusedCell = gridFocusCellSelector(apiRef);\n\n    if ((focusedCell == null ? void 0 : focusedCell.id) === id && focusedCell.field === field) {\n      return;\n    }\n\n    apiRef.current.setState(state => {\n      logger.debug(`Focusing on cell with id=${id} and field=${field}`);\n      return _extends({}, state, {\n        tabIndex: {\n          cell: {\n            id,\n            field\n          },\n          columnHeader: null\n        },\n        focus: {\n          cell: {\n            id,\n            field\n          },\n          columnHeader: null\n        }\n      });\n    });\n    apiRef.current.forceUpdate();\n    apiRef.current.publishEvent(GridEvents.cellFocusIn, apiRef.current.getCellParams(id, field));\n  }, [apiRef, logger]);\n  const setColumnHeaderFocus = React.useCallback((field, event = {}) => {\n    const cell = gridFocusCellSelector(apiRef);\n\n    if (cell) {\n      apiRef.current.publishEvent(GridEvents.cellFocusOut, apiRef.current.getCellParams(cell.id, cell.field), event);\n    }\n\n    apiRef.current.setState(state => {\n      logger.debug(`Focusing on column header with colIndex=${field}`);\n      return _extends({}, state, {\n        tabIndex: {\n          columnHeader: {\n            field\n          },\n          cell: null\n        },\n        focus: {\n          columnHeader: {\n            field\n          },\n          cell: null\n        }\n      });\n    });\n    apiRef.current.forceUpdate();\n  }, [apiRef, logger]);\n  const handleCellDoubleClick = React.useCallback(({\n    id,\n    field\n  }) => {\n    apiRef.current.setCellFocus(id, field);\n  }, [apiRef]);\n  const handleCellKeyDown = React.useCallback((params, event) => {\n    // GRID_CELL_NAVIGATION_KEY_DOWN handles the focus on Enter, Tab and navigation keys\n    if (event.key === 'Enter' || event.key === 'Tab' || isNavigationKey(event.key)) {\n      return;\n    }\n\n    apiRef.current.setCellFocus(params.id, params.field);\n  }, [apiRef]);\n  const handleColumnHeaderFocus = React.useCallback(({\n    field\n  }, event) => {\n    if (event.target !== event.currentTarget) {\n      return;\n    }\n\n    apiRef.current.setColumnHeaderFocus(field, event);\n  }, [apiRef]);\n  const handleBlur = React.useCallback(() => {\n    logger.debug(`Clearing focus`);\n    apiRef.current.setState(state => _extends({}, state, {\n      focus: {\n        cell: null,\n        columnHeader: null\n      }\n    }));\n  }, [logger, apiRef]);\n  const handleCellMouseUp = React.useCallback(params => {\n    lastClickedCell.current = params;\n  }, []);\n  const handleDocumentClick = React.useCallback(event => {\n    const cellParams = lastClickedCell.current;\n    lastClickedCell.current = null;\n    const focusedCell = gridFocusCellSelector(apiRef);\n\n    if (!focusedCell) {\n      if (cellParams) {\n        apiRef.current.setCellFocus(cellParams.id, cellParams.field);\n      }\n\n      return;\n    }\n\n    if ((cellParams == null ? void 0 : cellParams.id) === focusedCell.id && (cellParams == null ? void 0 : cellParams.field) === focusedCell.field) {\n      return;\n    }\n\n    const cellElement = apiRef.current.getCellElement(focusedCell.id, focusedCell.field);\n\n    if (cellElement != null && cellElement.contains(event.target)) {\n      return;\n    } // The row might have been deleted during the click\n\n\n    if (!apiRef.current.getRow(focusedCell.id)) {\n      return;\n    } // There's a focused cell but another cell was clicked\n    // Publishes an event to notify that the focus was lost\n\n\n    apiRef.current.publishEvent(GridEvents.cellFocusOut, apiRef.current.getCellParams(focusedCell.id, focusedCell.field), event);\n\n    if (cellParams) {\n      apiRef.current.setCellFocus(cellParams.id, cellParams.field);\n    } else {\n      apiRef.current.setState(state => _extends({}, state, {\n        focus: {\n          cell: null,\n          columnHeader: null\n        }\n      }));\n      apiRef.current.forceUpdate();\n    }\n  }, [apiRef]);\n  const handleCellModeChange = React.useCallback(params => {\n    if (params.cellMode === 'view') {\n      return;\n    }\n\n    const cell = gridFocusCellSelector(apiRef);\n\n    if ((cell == null ? void 0 : cell.id) !== params.id || (cell == null ? void 0 : cell.field) !== params.field) {\n      apiRef.current.setCellFocus(params.id, params.field);\n    }\n  }, [apiRef]);\n  useGridApiMethod(apiRef, {\n    setCellFocus,\n    setColumnHeaderFocus\n  }, 'GridFocusApi');\n  React.useEffect(() => {\n    const cell = gridFocusCellSelector(apiRef);\n\n    if (cell) {\n      const updatedRow = apiRef.current.getRow(cell.id);\n\n      if (!updatedRow) {\n        apiRef.current.setState(state => _extends({}, state, {\n          focus: {\n            cell: null,\n            columnHeader: null\n          }\n        }));\n      }\n    }\n  }, [apiRef, props.rows]);\n  React.useEffect(() => {\n    const doc = ownerDocument(apiRef.current.rootElementRef.current);\n    doc.addEventListener('click', handleDocumentClick);\n    return () => {\n      doc.removeEventListener('click', handleDocumentClick);\n    };\n  }, [apiRef, handleDocumentClick]);\n  useGridApiEventHandler(apiRef, GridEvents.columnHeaderBlur, handleBlur);\n  useGridApiEventHandler(apiRef, GridEvents.cellDoubleClick, handleCellDoubleClick);\n  useGridApiEventHandler(apiRef, GridEvents.cellMouseUp, handleCellMouseUp);\n  useGridApiEventHandler(apiRef, GridEvents.cellKeyDown, handleCellKeyDown);\n  useGridApiEventHandler(apiRef, GridEvents.cellModeChange, handleCellModeChange);\n  useGridApiEventHandler(apiRef, GridEvents.columnHeaderFocus, handleColumnHeaderFocus);\n};"]},"metadata":{},"sourceType":"module"}